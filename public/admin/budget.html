<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>× ×™×”×•×œ ×ª×§×¦×™×‘ - ××¢×¨×›×ª × ×™×”×•×œ ×™×™×©×•×‘ ××™×¦×“</title>
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="stylesheet" href="/admin/admin.css">
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="admin-layout">
    <!-- Sidebar -->
    <aside class="admin-sidebar">
      <div class="sidebar-header">
        <h2>××™×¦×“</h2>
        <span>××¢×¨×›×ª × ×™×”×•×œ ×™×™×©×•×‘</span>
      </div>

      <nav class="sidebar-nav">
        <div class="nav-section">
          <span class="nav-section-title">×¨××©×™</span>
          <a href="/admin/dashboard.html" class="nav-item">
            <span class="nav-icon">ğŸ“Š</span>
            <span class="nav-text">×œ×•×— ×‘×§×¨×”</span>
          </a>
          <a href="/admin/requests.html" class="nav-item">
            <span class="nav-icon">ğŸ“¬</span>
            <span class="nav-text">×¤× ×™×•×ª ×ª×•×©×‘×™×</span>
            <span class="nav-badge" id="newRequestsBadge">0</span>
          </a>
        </div>

        <div class="nav-section">
          <span class="nav-section-title">×§×”×™×œ×”</span>
          <a href="/admin/events.html" class="nav-item">
            <span class="nav-icon">ğŸ“…</span>
            <span class="nav-text">×œ×•×— ××™×¨×•×¢×™×</span>
          </a>
          <a href="/admin/announcements.html" class="nav-item">
            <span class="nav-icon">ğŸ“¢</span>
            <span class="nav-text">×”×•×“×¢×•×ª ×•×”×›×¨×–×•×ª</span>
            <span class="nav-badge urgent" id="urgentAnnouncementsBadge" style="display:none">!</span>
          </a>
          <a href="/admin/directory.html" class="nav-item">
            <span class="nav-icon">ğŸ“–</span>
            <span class="nav-text">×¡×¤×¨ ×˜×œ×¤×•× ×™×</span>
          </a>
          <a href="/admin/polls.html" class="nav-item">
            <span class="nav-icon">ğŸ—³ï¸</span>
            <span class="nav-text">×¡×§×¨×™× ×•×”×¦×‘×¢×•×ª</span>
          </a>
        </div>

        <div class="nav-section">
          <span class="nav-section-title">××©××‘×™×</span>
          <a href="/admin/facilities.html" class="nav-item">
            <span class="nav-icon">ğŸ›ï¸</span>
            <span class="nav-text">×”×–×× ×ª ××ª×§× ×™×</span>
            <span class="nav-badge" id="pendingBookingsBadge" style="display:none">0</span>
          </a>
          <a href="/admin/documents.html" class="nav-item">
            <span class="nav-icon">ğŸ“„</span>
            <span class="nav-text">××¡××›×™× ×•× ×”×œ×™×</span>
          </a>
          <a href="/admin/maintenance.html" class="nav-item">
            <span class="nav-icon">ğŸ”§</span>
            <span class="nav-text">×ª×—×–×•×§×”</span>
          </a>
        </div>

        <div class="nav-section">
          <span class="nav-section-title">× ×™×”×•×œ</span>
          <a href="/admin/meetings.html" class="nav-item">
            <span class="nav-icon">ğŸ—“ï¸</span>
            <span class="nav-text">×™×©×™×‘×•×ª ×•×¤×¨×•×˜×•×§×•×œ×™×</span>
          </a>
          <a href="/admin/budget.html" class="nav-item active">
            <span class="nav-icon">ğŸ’°</span>
            <span class="nav-text">×ª×§×¦×™×‘ ×•×›×¡×¤×™×</span>
          </a>
          <a href="/admin/planning.html" class="nav-item">
            <span class="nav-icon">ğŸ“‹</span>
            <span class="nav-text">×ª×›× ×•×Ÿ ×•×¤×¨×•×™×§×˜×™×</span>
          </a>
          <a href="/admin/employees.html" class="nav-item">
            <span class="nav-icon">ğŸ‘¥</span>
            <span class="nav-text">×¢×•×‘×“×™×</span>
          </a>
          <a href="/admin/infrastructure.html" class="nav-item">
            <span class="nav-icon">ğŸ—ï¸</span>
            <span class="nav-text">×ª×©×ª×™×•×ª</span>
          </a>
          <a href="/admin/settings.html" class="nav-item">
            <span class="nav-icon">âš™ï¸</span>
            <span class="nav-text">×”×’×“×¨×•×ª</span>
          </a>
        </div>
      </nav>

      <div class="sidebar-footer">
        <a href="/citizen/submit.html" class="nav-item" target="_blank">
          <span class="nav-icon">ğŸ“</span>
          <span class="nav-text">×¤×•×¨×˜×œ ×ª×•×©×‘×™×</span>
        </a>
        <a href="/" class="nav-item">
          <span class="nav-icon">ğŸ </span>
          <span class="nav-text">×œ××ª×¨ ×”×¨××©×™</span>
        </a>
        <a href="#" class="nav-item" onclick="logout()">
          <span class="nav-icon">ğŸšª</span>
          <span class="nav-text">×”×ª× ×ª×§×•×ª</span>
        </a>
      </div>
    </aside>

    <!-- Mobile Menu Toggle -->
    <button class="admin-menu-toggle" onclick="toggleSidebar()">â˜°</button>

    <!-- Main Content -->
    <main class="admin-main">
      <header class="admin-header">
        <div class="header-right">
          <h1>× ×™×”×•×œ ×ª×§×¦×™×‘</h1>
          <select id="yearSelect" class="year-select" onchange="loadBudgetData()">
            <option value="2026">2026</option>
            <option value="2025">2025</option>
            <option value="2024">2024</option>
          </select>
        </div>
        <div class="header-left">
          <button class="btn btn-secondary" onclick="exportReport()">
            <span>ğŸ“¥</span> ×™×™×¦×•× ×“×•"×—
          </button>
          <button class="btn btn-primary" onclick="showAddTransactionModal()">
            <span>â•</span> ×”×•×¡×¤×ª ×ª× ×•×¢×”
          </button>
          <div class="header-user">
            <span id="userName">×©×œ×•×</span>
          </div>
        </div>
      </header>

      <div class="admin-content">
        <!-- Budget Overview Cards -->
        <section class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon" style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);">ğŸ“ˆ</div>
            <div class="stat-info">
              <span class="stat-value" id="totalIncome">â‚ª0</span>
              <span class="stat-label">×”×›× ×¡×•×ª</span>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon" style="background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);">ğŸ“‰</div>
            <div class="stat-info">
              <span class="stat-value" id="totalExpenses">â‚ª0</span>
              <span class="stat-label">×”×•×¦××•×ª</span>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon" style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);">ğŸ’µ</div>
            <div class="stat-info">
              <span class="stat-value" id="balance">â‚ª0</span>
              <span class="stat-label">×™×ª×¨×”</span>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon" style="background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);">ğŸ“Š</div>
            <div class="stat-info">
              <span class="stat-value" id="budgetUsed">0%</span>
              <span class="stat-label">× ×™×¦×•×œ ×ª×§×¦×™×‘</span>
            </div>
          </div>
        </section>

        <!-- Charts Section -->
        <div class="charts-grid">
          <section class="dashboard-section">
            <div class="section-header">
              <h2>ğŸ“Š ×”×•×¦××•×ª ×œ×¤×™ ×§×˜×’×•×¨×™×”</h2>
            </div>
            <div class="chart-container">
              <canvas id="expensesPieChart"></canvas>
            </div>
          </section>

          <section class="dashboard-section">
            <div class="section-header">
              <h2>ğŸ“ˆ ××’××•×ª ×—×•×“×©×™×•×ª</h2>
            </div>
            <div class="chart-container">
              <canvas id="monthlyTrendChart"></canvas>
            </div>
          </section>
        </div>

        <!-- Budget Categories -->
        <section class="dashboard-section">
          <div class="section-header">
            <h2>ğŸ’° ×ª×§×¦×™×‘ ×œ×¤×™ ×§×˜×’×•×¨×™×”</h2>
            <button class="btn btn-secondary btn-sm" onclick="showBudgetAllocationModal()">×¢×¨×™×›×ª ×”×§×¦××•×ª</button>
          </div>
          <div class="budget-categories" id="budgetCategories">
            <!-- Loaded dynamically -->
          </div>
        </section>

        <!-- Reports Section -->
        <section class="dashboard-section reports-section">
          <div class="section-header">
            <h2>ğŸ“Š ×™×™×¦×•× ×“×•×—×•×ª</h2>
          </div>
          <div class="reports-grid">
            <div class="report-card" onclick="exportToExcel('monthly')">
              <span class="report-icon">ğŸ“…</span>
              <h4>×“×•"×— ×—×•×“×©×™</h4>
              <p>×¡×™×›×•× ×”×›× ×¡×•×ª ×•×”×•×¦××•×ª ×œ×—×•×“×© × ×‘×—×¨</p>
            </div>
            <div class="report-card" onclick="exportToExcel('quarterly')">
              <span class="report-icon">ğŸ“ˆ</span>
              <h4>×“×•"×— ×¨×‘×¢×•× ×™</h4>
              <p>×”×©×•×•××” ×¨×‘×¢×•× ×™×ª ×©×œ ×ª×§×¦×™×‘ ××•×œ ×‘×™×¦×•×¢</p>
            </div>
            <div class="report-card" onclick="exportToExcel('annual')">
              <span class="report-icon">ğŸ“Š</span>
              <h4>×“×•"×— ×©× ×ª×™</h4>
              <p>×¡×™×›×•× ××œ× ×©×œ ×”×©× ×” ×”× ×‘×—×¨×ª</p>
            </div>
            <div class="report-card" onclick="exportToExcel('category')">
              <span class="report-icon">ğŸ“‚</span>
              <h4>×¤×™×¨×•×˜ ×œ×¤×™ ×§×˜×’×•×¨×™×”</h4>
              <p>×”×ª×¤×œ×’×•×ª ×”×•×¦××•×ª ×•×”×›× ×¡×•×ª ×œ×¤×™ ×§×˜×’×•×¨×™×”</p>
            </div>
            <div class="report-card" onclick="exportToExcel('all')">
              <span class="report-icon">ğŸ“‹</span>
              <h4>×›×œ ×”×ª× ×•×¢×•×ª</h4>
              <p>×™×™×¦×•× ××œ× ×©×œ ×›×œ ×”×ª× ×•×¢×•×ª ×œ××§×¡×œ</p>
            </div>
            <div class="report-card" onclick="connectFinanceAPI()">
              <span class="report-icon">ğŸ”—</span>
              <h4>×—×™×‘×•×¨ ×œ××¢×¨×›×ª ×—×©×‘×•× ×•×ª</h4>
              <p>×¡× ×›×¨×•×Ÿ ×¢× ×ª×•×›× ×” ×¤×™× × ×¡×™×ª ×—×™×¦×•× ×™×ª</p>
            </div>
          </div>
        </section>

        <!-- Recent Transactions -->
        <section class="dashboard-section">
          <div class="section-header">
            <h2>ğŸ“ ×ª× ×•×¢×•×ª ××—×¨×•× ×•×ª</h2>
            <div class="section-actions">
              <button class="btn btn-secondary btn-sm" onclick="exportToExcel('all')">ğŸ“¥ ××§×¡×œ</button>
              <a href="#" class="btn btn-secondary btn-sm" onclick="showAllTransactions()">×›×œ ×”×ª× ×•×¢×•×ª</a>
            </div>
          </div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>×ª××¨×™×š</th>
                  <th>×ª×™××•×¨</th>
                  <th>×§×˜×’×•×¨×™×”</th>
                  <th>×¡×•×’</th>
                  <th>×¡×›×•×</th>
                  <th>×¤×¢×•×œ×•×ª</th>
                </tr>
              </thead>
              <tbody id="transactionsTable">
                <tr>
                  <td colspan="6" class="loading">×˜×•×¢×Ÿ...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>
      </div>
    </main>
  </div>

  <!-- Transaction Modal -->
  <div id="transactionModal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-header">
        <h3 id="modalTitle">×”×•×¡×¤×ª ×ª× ×•×¢×”</h3>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="transactionForm">
          <div class="form-row">
            <div class="form-group">
              <label>×¡×•×’ ×ª× ×•×¢×” *</label>
              <select id="transType" name="type" required onchange="updateCategoryOptions()">
                <option value="expense">×”×•×¦××”</option>
                <option value="income">×”×›× ×¡×”</option>
              </select>
            </div>
            <div class="form-group">
              <label>×ª××¨×™×š *</label>
              <input type="date" id="transDate" name="date" required>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>×§×˜×’×•×¨×™×” *</label>
              <select id="transCategory" name="category" required>
                <option value="">×‘×—×¨ ×§×˜×’×•×¨×™×”</option>
              </select>
            </div>
            <div class="form-group">
              <label>×¡×›×•× (â‚ª) *</label>
              <input type="number" id="transAmount" name="amount" min="0" step="0.01" required>
            </div>
          </div>
          <div class="form-group full">
            <label>×ª×™××•×¨ *</label>
            <input type="text" id="transDescription" name="description" required>
          </div>
          <div class="form-group full">
            <label>×”×¢×¨×•×ª</label>
            <textarea id="transNotes" name="notes" rows="2"></textarea>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>×¡×¤×§ / ××§×•×¨</label>
              <input type="text" id="transVendor" name="vendor">
            </div>
            <div class="form-group">
              <label>××¡×¤×¨ ×—×©×‘×•× ×™×ª</label>
              <input type="text" id="transInvoice" name="invoice_number">
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal()">×‘×™×˜×•×œ</button>
        <button class="btn btn-primary" onclick="saveTransaction()">×©××™×¨×”</button>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast hidden"></div>

  <!-- Finance API Connection Modal -->
  <div id="financeAPIModal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-header">
        <h3>×—×™×‘×•×¨ ×œ××¢×¨×›×ª ×—×©×‘×•× ×•×ª</h3>
        <button class="modal-close" onclick="closeFinanceModal()">&times;</button>
      </div>
      <div class="modal-body">
        <p class="info-text">×‘×—×¨ ××ª ×ª×•×›× ×ª × ×™×”×•×œ ×”×—×©×‘×•× ×•×ª ×©×œ×š ×œ×¡× ×›×¨×•×Ÿ × ×ª×•× ×™×:</p>
        <div class="finance-options">
          <div class="finance-option" onclick="selectFinanceSystem('hashavshevet')">
            <span class="system-icon">ğŸ“Š</span>
            <span class="system-name">×—×©×‘×©×‘×ª</span>
          </div>
          <div class="finance-option" onclick="selectFinanceSystem('priority')">
            <span class="system-icon">ğŸ¢</span>
            <span class="system-name">Priority ERP</span>
          </div>
          <div class="finance-option" onclick="selectFinanceSystem('rivhit')">
            <span class="system-icon">ğŸ’¹</span>
            <span class="system-name">×¨×•×•×—×™×ª</span>
          </div>
          <div class="finance-option" onclick="selectFinanceSystem('custom')">
            <span class="system-icon">âš™ï¸</span>
            <span class="system-name">API ××•×ª××</span>
          </div>
        </div>
        <div id="apiConfigSection" class="hidden" style="margin-top: 20px;">
          <div class="form-group">
            <label>×›×ª×•×‘×ª API</label>
            <input type="url" id="financeApiUrl" placeholder="https://api.yourfinance.com">
          </div>
          <div class="form-group">
            <label>××¤×ª×— API</label>
            <input type="password" id="financeApiKey" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeFinanceModal()">×‘×™×˜×•×œ</button>
        <button class="btn btn-primary" onclick="saveFinanceConnection()">×©××•×¨ ×•×‘×“×•×§ ×—×™×‘×•×¨</button>
      </div>
    </div>
  </div>

  <style>
    /* Reports Grid */
    .reports-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--space-4);
      margin-top: var(--space-4);
    }
    .report-card {
      background: var(--gray-50);
      border: 1px solid var(--gray-100);
      border-radius: 12px;
      padding: var(--space-4);
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .report-card:hover {
      background: var(--primary-50);
      border-color: var(--primary-200);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .report-icon {
      font-size: 2rem;
      display: block;
      margin-bottom: var(--space-2);
    }
    .report-card h4 {
      margin: 0 0 var(--space-1) 0;
      font-size: 1rem;
      color: var(--gray-800);
    }
    .report-card p {
      margin: 0;
      font-size: 0.8rem;
      color: var(--gray-500);
    }
    .section-actions {
      display: flex;
      gap: var(--space-2);
    }

    /* Finance API Modal */
    .finance-options {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--space-3);
      margin-top: var(--space-4);
    }
    .finance-option {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: var(--space-4);
      border: 2px solid var(--gray-200);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .finance-option:hover {
      border-color: var(--primary-500);
      background: var(--primary-50);
    }
    .finance-option.selected {
      border-color: var(--primary-600);
      background: var(--primary-100);
    }
    .system-icon { font-size: 2rem; margin-bottom: var(--space-2); }
    .system-name { font-weight: 600; }
    .info-text { color: var(--gray-600); margin-bottom: var(--space-2); }
  </style>

  <script src="/js/budget.js"></script>
  <script>
    // Excel Export Functions
    async function exportToExcel(reportType) {
      const year = document.getElementById('yearSelect').value;
      showToast('××›×™×Ÿ ×“×•"×—...', 'info');

      try {
        const response = await fetch(`/api/budget/export/${reportType}?year=${year}`, {
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('meitzad_token') || localStorage.getItem('authToken')}`
          }
        });

        if (!response.ok) throw new Error('×©×’×™××” ×‘×™×™×¦×•×');

        const blob = await response.blob();
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `budget_${reportType}_${year}.xlsx`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        showToast('×”×“×•"×— ×”×•×¨×“ ×‘×”×¦×œ×—×”', 'success');
      } catch (error) {
        console.error('Export error:', error);
        // Fallback to CSV export
        exportToCSV(reportType, year);
      }
    }

    async function exportToCSV(reportType, year) {
      try {
        const response = await fetch(`/api/budget/transactions?year=${year}&limit=9999`, {
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('meitzad_token') || localStorage.getItem('authToken')}`
          }
        });
        const transactions = await response.json();

        if (!transactions || transactions.length === 0) {
          showToast('××™×Ÿ × ×ª×•× ×™× ×œ×™×™×¦×•×', 'warning');
          return;
        }

        // Create CSV content
        const headers = ['×ª××¨×™×š', '×ª×™××•×¨', '×§×˜×’×•×¨×™×”', '×¡×•×’', '×¡×›×•×', '×”×¢×¨×•×ª'];
        const categoryLabels = {
          infrastructure: '×ª×©×ª×™×•×ª', maintenance: '×ª×—×–×•×§×”', security: '×‘×™×˜×—×•×Ÿ',
          education: '×—×™× ×•×š', welfare: '×¨×•×•×—×”', employees: '×¢×•×‘×“×™×',
          taxes: '××™×¡×™×', other: '××—×¨'
        };

        let csv = '\uFEFF' + headers.join(',') + '\n'; // BOM for Hebrew
        transactions.forEach(tx => {
          csv += [
            new Date(tx.date).toLocaleDateString('he-IL'),
            `"${tx.description || ''}"`,
            categoryLabels[tx.category] || tx.category,
            tx.type === 'income' ? '×”×›× ×¡×”' : '×”×•×¦××”',
            tx.amount,
            `"${tx.notes || ''}"`
          ].join(',') + '\n';
        });

        // Download CSV
        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `budget_${reportType}_${year}.csv`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        showToast('×”×“×•"×— ×”×•×¨×“ ×›×§×•×‘×¥ CSV', 'success');
      } catch (error) {
        showToast('×©×’×™××” ×‘×™×™×¦×•×: ' + error.message, 'error');
      }
    }

    // Finance API Connection
    let selectedFinanceSystem = null;

    function connectFinanceAPI() {
      document.getElementById('financeAPIModal').classList.remove('hidden');
    }

    function closeFinanceModal() {
      document.getElementById('financeAPIModal').classList.add('hidden');
      selectedFinanceSystem = null;
      document.querySelectorAll('.finance-option').forEach(o => o.classList.remove('selected'));
      document.getElementById('apiConfigSection').classList.add('hidden');
    }

    function selectFinanceSystem(system) {
      selectedFinanceSystem = system;
      document.querySelectorAll('.finance-option').forEach(o => o.classList.remove('selected'));
      event.currentTarget.classList.add('selected');

      if (system === 'custom') {
        document.getElementById('apiConfigSection').classList.remove('hidden');
      } else {
        document.getElementById('apiConfigSection').classList.add('hidden');
      }
    }

    async function saveFinanceConnection() {
      if (!selectedFinanceSystem) {
        showToast('× × ×œ×‘×—×•×¨ ××¢×¨×›×ª ×—×©×‘×•× ×•×ª', 'error');
        return;
      }

      const config = {
        system: selectedFinanceSystem,
        apiUrl: document.getElementById('financeApiUrl').value,
        apiKey: document.getElementById('financeApiKey').value
      };

      try {
        await fetch('/api/settings/bulk', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${localStorage.getItem('meitzad_token') || localStorage.getItem('authToken')}`
          },
          body: JSON.stringify({
            finance_system: config.system,
            finance_api_url: config.apiUrl,
            finance_api_key: config.apiKey
          })
        });

        showToast('×”×’×“×¨×•×ª ×”×—×™×‘×•×¨ × ×©××¨×•. ×©×™× ×œ×‘: ×™×© ×œ×”×’×“×™×¨ API ×‘××¢×¨×›×ª ×”×—×™×¦×•× ×™×ª', 'success');
        closeFinanceModal();
      } catch (error) {
        showToast('×©×’×™××” ×‘×©××™×¨×ª ×”×’×“×¨×•×ª', 'error');
      }
    }

    function exportReport() {
      // Scroll to reports section
      document.querySelector('.reports-section').scrollIntoView({ behavior: 'smooth' });
    }

    function showToast(message, type = 'info') {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = `toast ${type}`;
      toast.classList.remove('hidden');
      setTimeout(() => toast.classList.add('hidden'), 4000);
    }
  </script>
</body>
</html>
