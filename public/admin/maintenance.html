<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>תחזוקה - מערכת ניהול יישוב מיצד</title>
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="stylesheet" href="/admin/admin.css">
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
  <div class="admin-layout">
    <aside class="admin-sidebar">
      <div class="sidebar-header">
        <h2>מיצד</h2>
        <span>מערכת ניהול יישוב</span>
      </div>

      <nav class="sidebar-nav">
        <div class="nav-section">
          <span class="nav-section-title">ראשי</span>
          <a href="/admin/dashboard.html" class="nav-item">
            <span class="nav-icon">📊</span>
            <span class="nav-text">לוח בקרה</span>
          </a>
          <a href="/admin/requests.html" class="nav-item">
            <span class="nav-icon">📬</span>
            <span class="nav-text">פניות תושבים</span>
            <span class="nav-badge" id="newRequestsBadge">0</span>
          </a>
        </div>

        <div class="nav-section">
          <span class="nav-section-title">קהילה</span>
          <a href="/admin/events.html" class="nav-item">
            <span class="nav-icon">📅</span>
            <span class="nav-text">לוח אירועים</span>
          </a>
          <a href="/admin/announcements.html" class="nav-item">
            <span class="nav-icon">📢</span>
            <span class="nav-text">הודעות והכרזות</span>
            <span class="nav-badge urgent" id="urgentAnnouncementsBadge" style="display:none">!</span>
          </a>
          <a href="/admin/directory.html" class="nav-item">
            <span class="nav-icon">📖</span>
            <span class="nav-text">ספר טלפונים</span>
          </a>
          <a href="/admin/polls.html" class="nav-item">
            <span class="nav-icon">🗳️</span>
            <span class="nav-text">סקרים והצבעות</span>
          </a>
        </div>

        <div class="nav-section">
          <span class="nav-section-title">משאבים</span>
          <a href="/admin/facilities.html" class="nav-item">
            <span class="nav-icon">🏛️</span>
            <span class="nav-text">הזמנת מתקנים</span>
            <span class="nav-badge" id="pendingBookingsBadge" style="display:none">0</span>
          </a>
          <a href="/admin/documents.html" class="nav-item">
            <span class="nav-icon">📄</span>
            <span class="nav-text">מסמכים ונהלים</span>
          </a>
          <a href="/admin/maintenance.html" class="nav-item active">
            <span class="nav-icon">🔧</span>
            <span class="nav-text">תחזוקה</span>
          </a>
        </div>

        <div class="nav-section">
          <span class="nav-section-title">ניהול</span>
          <a href="/admin/meetings.html" class="nav-item">
            <span class="nav-icon">🗓️</span>
            <span class="nav-text">ישיבות ופרוטוקולים</span>
          </a>
          <a href="/admin/budget.html" class="nav-item">
            <span class="nav-icon">💰</span>
            <span class="nav-text">תקציב וכספים</span>
          </a>
          <a href="/admin/planning.html" class="nav-item">
            <span class="nav-icon">📋</span>
            <span class="nav-text">תכנון ופרויקטים</span>
          </a>
          <a href="/admin/employees.html" class="nav-item">
            <span class="nav-icon">👥</span>
            <span class="nav-text">עובדים</span>
          </a>
          <a href="/admin/infrastructure.html" class="nav-item">
            <span class="nav-icon">🏗️</span>
            <span class="nav-text">תשתיות</span>
          </a>
          <a href="/admin/settings.html" class="nav-item">
            <span class="nav-icon">⚙️</span>
            <span class="nav-text">הגדרות</span>
          </a>
        </div>
      </nav>

      <div class="sidebar-footer">
        <a href="/citizen/submit.html" class="nav-item" target="_blank">
          <span class="nav-icon">📝</span>
          <span class="nav-text">פורטל תושבים</span>
        </a>
        <a href="/" class="nav-item">
          <span class="nav-icon">🏠</span>
          <span class="nav-text">לאתר הראשי</span>
        </a>
        <a href="#" class="nav-item" onclick="logout()">
          <span class="nav-icon">🚪</span>
          <span class="nav-text">התנתקות</span>
        </a>
      </div>
    </aside>

    <button class="admin-menu-toggle" onclick="toggleSidebar()">☰</button>

    <main class="admin-main">
      <header class="admin-header">
        <div class="header-right"><h1>🔧 ניהול תחזוקה</h1></div>
        <div class="header-left">
          <button class="btn btn-primary" onclick="addWorkOrder()">➕ הזמנת עבודה</button>
        </div>
      </header>

      <div class="admin-content">
        <section class="stats-grid small">
          <div class="stat-card mini"><div class="stat-icon new">📝</div><div class="stat-info"><span class="stat-value">5</span><span class="stat-label">פתוחות</span></div></div>
          <div class="stat-card mini"><div class="stat-icon progress">⏳</div><div class="stat-info"><span class="stat-value">3</span><span class="stat-label">בביצוע</span></div></div>
          <div class="stat-card mini"><div class="stat-icon resolved">✅</div><div class="stat-info"><span class="stat-value">28</span><span class="stat-label">הושלמו החודש</span></div></div>
          <div class="stat-card mini"><div class="stat-icon time">⏱️</div><div class="stat-info"><span class="stat-value">2.5</span><span class="stat-label">ימים ממוצע</span></div></div>
        </section>

        <section class="dashboard-section">
          <div class="section-header"><h2>הזמנות עבודה פעילות</h2></div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr><th>מס'</th><th>תיאור</th><th>מיקום</th><th>דחיפות</th><th>סטטוס</th><th>אחראי</th><th>פעולות</th></tr>
              </thead>
              <tbody id="workOrdersTable"></tbody>
            </table>
          </div>
        </section>
      </div>
    </main>
  </div>

  <div id="toast" class="toast hidden"></div>

  <script>
    const workOrders = [
      { id: 1, number: 'WO-2026-001', description: 'תיקון מנורת רחוב', location: 'רחוב הדקלים 5', priority: 'normal', status: 'in_progress', assignee: 'אבי מזרחי' },
      { id: 2, number: 'WO-2026-002', description: 'צביעת גדר מגרש', location: 'מגרש כדורגל', priority: 'low', status: 'new', assignee: 'דוד לוי' },
      { id: 3, number: 'WO-2026-003', description: 'תיקון ברז במועדון', location: 'מועדון נוער', priority: 'high', status: 'in_progress', assignee: 'אבי מזרחי' },
      { id: 4, number: 'WO-2026-004', description: 'החלפת שלט כניסה', location: 'כניסה ליישוב', priority: 'normal', status: 'new', assignee: '-' },
      { id: 5, number: 'WO-2026-005', description: 'גיזום עצים', location: 'שדרה מרכזית', priority: 'normal', status: 'new', assignee: 'דוד לוי' }
    ];

    const priorityMap = { low: 'נמוכה', normal: 'רגילה', high: 'גבוהה', urgent: 'דחופה' };
    const statusMap = { new: 'חדש', in_progress: 'בביצוע', completed: 'הושלם' };

    function renderWorkOrders() {
      const tbody = document.getElementById('workOrdersTable');
      tbody.innerHTML = workOrders.map(wo => `
        <tr>
          <td><strong>${wo.number}</strong></td>
          <td>${wo.description}</td>
          <td>${wo.location}</td>
          <td><span class="priority-badge priority-${wo.priority}">${priorityMap[wo.priority]}</span></td>
          <td><span class="status-badge status-${wo.status}">${statusMap[wo.status]}</span></td>
          <td>${wo.assignee}</td>
          <td>
            <button class="action-btn" onclick="editWorkOrder(${wo.id})" title="עריכה">✏️</button>
            <button class="action-btn" onclick="completeWorkOrder(${wo.id})" title="סיום">✅</button>
          </td>
        </tr>
      `).join('');
    }

    function addWorkOrder() { showToast('הוספת הזמנת עבודה - בקרוב', 'info'); }
    function editWorkOrder(id) { showToast('עריכה - בקרוב', 'info'); }
    function completeWorkOrder(id) { showToast('הושלם בהצלחה', 'success'); }
    function toggleSidebar() { document.querySelector('.admin-sidebar').classList.toggle('open'); }
    function logout() { localStorage.removeItem('authToken'); window.location.href = '/#login'; }
    function showToast(message, type = 'info') {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = `toast ${type}`;
      toast.classList.remove('hidden');
      setTimeout(() => toast.classList.add('hidden'), 4000);
    }

    renderWorkOrders();
  </script>
</body>
</html>
